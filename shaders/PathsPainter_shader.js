/* eslint-disable */
export default "precision mediump float;\r\nvarying vec2 vPosition;\r\nuniform mat3 uMatrixInverse;\r\nuniform sampler2D uData;\r\nuniform vec2 uTextureSize;\r\nuniform int uPathLength;\r\n\r\n// Signed distance to a line segment\r\nfloat sdSegment( in vec2 p, in vec2 a, in vec2 b ) {\r\n  vec2 pa = p-a, ba = b-a;\r\n  float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\r\n  return length( pa - ba*h );\r\n}\r\n\r\n// Given an index into our \"vec3 data array\", returns the vec3\r\nvec4 fetch( in int index ) {\r\n  vec2 coordinates = vec2( mod( float( index ), uTextureSize.x ), floor( float( index ) / uTextureSize.x ) );\r\n  return texture2D( uData, ( coordinates + 0.5 ) / uTextureSize );\r\n}\r\n\r\nvec2 globalToModel( in vec2 modelPoint ) {\r\n  return ( uMatrixInverse * vec3( modelPoint, 1.0 ) ).xy;\r\n}\r\n\r\nvec4 distToValue( in float dist, in int closestIndex ) {\r\n  // divider: 0 when beggining closestIndex == 0\r\n  // 1 when ending. closestIndex == PathLength\r\n  float divider = float( closestIndex ) / float( uPathLength + 1 );\r\n  float value = smoothstep( 4.0 * divider, divider , dist );\r\n  // return vec4( vec3( value ), 0.9 );\r\n  return vec4( vec3( value ), value * divider * divider );\r\n}\r\n\r\nvec4 getStroke( in vec2 modelPosition ) {\r\n  float dist = 1000.0;\r\n  float value = 0.0;\r\n  int closestIndex = uPathLength;\r\n\r\n  for ( int i = 0 ; i < 1000 ; i++ ) {\r\n    if ( i == ( uPathLength - 1 ) ) {\r\n      return distToValue( dist, closestIndex );\r\n    }\r\n    vec2 position0 = fetch( i ).xy;\r\n    vec2 position1 = fetch( i + 1 ).xy;\r\n\r\n    float newDistance = sdSegment( modelPosition, position0, position1 );\r\n    if ( newDistance < dist ) {\r\n      dist = newDistance;\r\n      closestIndex = i;\r\n    }\r\n  }\r\n  return distToValue( dist, closestIndex );\r\n}\r\n\r\n// Returns the color from the vertex shader\r\nvoid main( void ) {\r\n  vec2 modelPosition = globalToModel( vPosition );\r\n  vec4 stroke = getStroke( modelPosition );\r\n  gl_FragColor = stroke;\r\n}"